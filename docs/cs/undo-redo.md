---
title: 撤销回退-如何找回正确的集体历史记忆
outline: deep
---

# 撤销回退-如何找回正确的集体历史记忆

撤销(redo)和回退(undo)是其中比较重要的部分,其实现也较为有意思。从设计模式上来看实现 redo 和 undo 有两种常用的模式
1. 命令模式
2. 备忘录模式

两种模式都有各自的优缺点

## 基于命令模式
命令模式是编辑器中常见的用于实现撤销和回退的设计模式，它将命令抽象为一个类，在调用者和接收者解耦

![](./assets/command-pattern.png)

## 命令模式可以带来什么好处？
从最简单的场景思考，如果我们要开发一个通用的编辑器。界面上每一个按钮都有相应的功能，例如保存，撤销和重做。当然，最先想到就是一个按钮对应一个封装好的函数

```ts
function save(params){
  // ...
}
```
这样做是最简单和自然的做法，但是如果在此基础之上继续增加功能，例如记录用户的操作序列


## 基于状态快照
